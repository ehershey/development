<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" >
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
		<title>Duncan's Just-In-Time Donuts'</title>
		<link rel="stylesheet" type="text/css" href="TraceTest.css" />
		<script type="text/javascript" src="traceutil.js"></script>
		<script type="text/javascript" src="AjaxRequest.js"></script>
		<script type="text/javascript">

			var console = null;
			var blogEntrys = [];

			// ============================================================================
			// ============================================================================
			// Begin------------Blog class definition.
			// ============================================================================
			// ============================================================================

			// Construction
			function Blog(entry,entry_date,image_name)
			{
				this.entry = entry;
				this.entry_date = new Date(entry_date);
				this.image_name = image_name;
			}

			// base-class definition.. note how this is very different 
			// from C++, where a class method is by definition shared 
			// between all instances.. here we essentially make the method
			// part of the base class (by using the prototype syntax).. 
			// if we don't, then each instance gets its own copy of the function
			// which wastes a ton of space if there are a lot of instances..
			Blog.prototype.formatDate = function()
			{
				// since we used 'prototype'.. we can see the instance variables
				// using 'this.<instancevar> syntax.
				return 					(this.entry_date.getMonth()  + 1)
					   				+ 	"/" 
					   				+  	this.entry_date.getDate() 
					   				+ 	"/" 
					   				+  	this.entry_date.getFullYear() ;

			}

			Blog.prototype.toHTML = function(classname)
			{
				// shows use of base class defined function.
				entryHTML = "<strong>" 	
							+ 	this.formatDate()
							+ 	"</strong><br />" 
							+ "<table class='" + classname + "'><tr><td>";

				if(this.image_name != null)
				{
					entryHTML += "<img src='" + this.image_name + "' />";
				}

				entryHTML += 	"</td><td style='vertical-align:top'>" 
								+ this.entry
								+ "</td></tr></table>";
				return entryHTML;
			}

			// a function that canNOT access instance variables.. so its just owned at the class
			// level ALONE.  useful for class related functions.. so that they aren't free standing
			// if they don't need to be.
			Blog.compareEntries = function(blog1,blog2)
			{
				return blog2.entry_date - blog1.entry_date;
			}
			// ============================================================================
			// ============================================================================
			// END--------Blog class definition.
			// ============================================================================
			// ============================================================================

			function updateBlog()
			{

				blogtext = "";
				for(currBlogEntry =0; currBlogEntry < blogEntrys.length; currBlogEntry++)
				{
					console.displayMsg("updateBlog","currBlogEntry",currBlogEntry );
					if(blogEntrys[currBlogEntry] != null)
					{
						if((currBlogEntry % 2) == 0)
						{
							classname="blog_entry_shaded";
						}
						else
						{
							classname="blog_entry_white";
						}
						blogtext += "<p class='" + classname +"'>";
						blogtext += blogEntrys[currBlogEntry].toHTML(classname) + "</p>";
					}
				}
				document.getElementById("body1stdiv").innerHTML = blogtext;
			}
			window.onload = function()
			{

				blogEntrys = [	new Blog("my second entry!","8/14/2009","cube777.png"),
								new Blog("my first entry!","8/12/2009"),
								new Blog("my fourth entry!","8/17/2009"),
								new Blog("my third entry!","8/15/2009","cube777.png")];

				// executes a sort, using our custom sort func.
				blogEntrys.sort(Blog.compareEntries);

				document.getElementById("updateblogbutton").onclick = updateBlog;

				// create our DebugConsole AFTER the page has loaded..
				console = new DebugConsole();

				updateBlog();
			}

			
			
		</script>
	</head>
	<body >
		<div class="main" id="body1stdiv" name="body1stdiv">

		</div>
		<button id="updateblogbutton" name "updateblogbutton">update blog</button>
	</body>
</html>
